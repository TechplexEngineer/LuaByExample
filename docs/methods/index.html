<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Lua by Example: Methods</title>
    <link rel=stylesheet href="/site.css">
    <link rel=stylesheet href="/monokai.css">
  </head>
  <script>
      onkeydown = (e) => {
          
          if (e.key === "ArrowLeft") {
              window.location.href = '/variadic-functions';
          }
          
          
          if (e.key === "ArrowRight") {
              window.location.href = '/json-and-library-loading';
          }
          
      }
  </script>
  <body>
    <div class="example" id="methods">
      <h2><a href="/">Lua by Example</a>: Methods</h2>
      
      
      <table>
        
        <tr>
          <td class="docs">
            <p>lua supports <em>methods</em> defined on tables.</p>

          </td>
          <td class="code empty leading">
            
            
          
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>items declared in this table are shared between all instances
but can be overridden</p>

          </td>
          <td class="code leading">
            
            
              
              <img title="Copy code" src="/clipboard.png" class="copy" />
            
          <pre class="chroma">
<span class="kd">local</span> <span class="n">My_Psuedo_Class</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">shared</span> <span class="o">=</span> <span class="s2">&#34;string is shared&#34;</span>
<span class="p">}</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="kr">function</span> <span class="nc">My_Psuedo_Class</span><span class="p">:</span><span class="nf">new</span><span class="p">()</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>items declared in this table are unique between instances</p>

          </td>
          <td class="code leading">
            
            
          <pre class="chroma">
    <span class="kd">local</span> <span class="n">instance</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="s2">&#34;string is unique&#34;</span>
    <span class="p">}</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma">    <span class="n">setmetatable</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="p">{</span> <span class="n">__index</span> <span class="o">=</span> <span class="n">My_Psuedo_Class</span> <span class="p">})</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma">    <span class="kr">return</span> <span class="n">instance</span>
<span class="kr">end</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>declaration of a method that changes internal state</p>

          </td>
          <td class="code leading">
            
            
          <pre class="chroma">
<span class="kr">function</span> <span class="nc">My_Psuedo_Class</span><span class="p">:</span><span class="nf">method</span><span class="p">(</span><span class="n">new_val</span><span class="p">)</span>
    <span class="n">self.shared</span> <span class="o">=</span> <span class="n">new_val</span>
    <span class="n">self.unique</span> <span class="o">=</span> <span class="n">new_val</span>
<span class="kr">end</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>another method that prints internal state</p>

          </td>
          <td class="code leading">
            
            
          <pre class="chroma">
<span class="kr">function</span> <span class="nc">My_Psuedo_Class</span><span class="p">:</span><span class="nf">print</span><span class="p">()</span>
    <span class="n">print</span><span class="p">(</span><span class="s1">&#39;shared: &#39;</span><span class="p">,</span> <span class="n">self.shared</span><span class="p">,</span> <span class="s1">&#39; unique: &#39;</span><span class="o">..</span><span class="n">self.unique</span><span class="p">)</span>
<span class="kr">end</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="kd">local</span> <span class="n">instance_a</span> <span class="o">=</span> <span class="n">My_Psuedo_Class</span><span class="p">:</span><span class="n">new</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">instance_b</span> <span class="o">=</span> <span class="n">My_Psuedo_Class</span><span class="p">:</span><span class="n">new</span><span class="p">()</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="n">instance_a</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">instance_b</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">print</span><span class="p">()</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>we can change the shared state</p>

          </td>
          <td class="code leading">
            
            
          <pre class="chroma">
<span class="n">My_Psuedo_Class.shared</span> <span class="o">=</span> <span class="s2">&#34;new shared state&#34;</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="n">instance_a</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">instance_b</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">print</span><span class="p">()</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="n">instance_a</span><span class="p">:</span><span class="n">method</span><span class="p">(</span><span class="s1">&#39;overwrite first&#39;</span><span class="p">)</span>
<span class="n">instance_b</span><span class="p">:</span><span class="n">method</span><span class="p">(</span><span class="s1">&#39;overwrite second&#39;</span><span class="p">)</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="n">instance_a</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">instance_b</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">print</span><span class="p">()</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>once the members have overridden the shared state
changes will only affect new instances</p>

          </td>
          <td class="code leading">
            
            
          <pre class="chroma">
<span class="n">My_Psuedo_Class.shared</span> <span class="o">=</span> <span class="s2">&#34;only in inst. c&#34;</span>
<span class="kd">local</span> <span class="n">instance_c</span> <span class="o">=</span> <span class="n">My_Psuedo_Class</span><span class="p">:</span><span class="n">new</span><span class="p">()</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code">
            
            
          <pre class="chroma"><span class="n">instance_a</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">instance_b</span><span class="p">:</span><span class="n">print</span><span class="p">()</span>
<span class="n">instance_c</span><span class="p">:</span><span class="n">print</span><span class="p">()</span></pre>
          </td>
        </tr>
        
      </table>
      
      <table>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="gp">$</span> lua methods.lua
<span class="go">shared:     string is shared     unique: string is unique
</span><span class="go">shared:     string is shared     unique: string is unique</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="go">shared:     new shared state     unique: string is unique
</span><span class="go">shared:     new shared state     unique: string is unique</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
            
          <pre class="chroma"><span class="go">shared:     overwrite first     unique: overwrite first
</span><span class="go">shared:     overwrite second     unique: overwrite second</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code">
            
            
          <pre class="chroma"><span class="go">shared:     overwrite first     unique: overwrite first
</span><span class="go">shared:     overwrite second     unique: overwrite second
</span><span class="go">shared:     only in inst. c     unique: string is unique</span></pre>
          </td>
        </tr>
        
      </table>
      
      
      <p class="next">
        Next example: <a href="/json-and-library-loading">JSON and Library Loading</a>.
      </p>
      
      <p class="footer">
        by <a href="https://techplexlabs.com">Blake Bourque</a> |
        <a href="https://github.com/TechplexEngineer/LuaByExample/blob/master/examples/methods">source</a> |
        <a href="https://github.com/TechplexEngineer/LuaByExample#license">license</a>
      </p>
    </div>
    <script>
      var codeLines = [];
      codeLines.push('');
      codeLines.push('local My_Psuedo_Class = {\n    shared = \u0022string is shared\u0022\n}\n');
      codeLines.push('function My_Psuedo_Class:new()\n');
      codeLines.push('    local instance = {\n        unique = \u0022string is unique\u0022\n    }\n');
      codeLines.push('    setmetatable(instance, { __index = My_Psuedo_Class })\n');
      codeLines.push('    return instance\nend\n');
      codeLines.push('function My_Psuedo_Class:method(new_val)\n    self.shared = new_val\n    self.unique = new_val\nend\n');
      codeLines.push('function My_Psuedo_Class:print()\n    print(\u0027shared: \u0027, self.shared, \u0027 unique: \u0027..self.unique)\nend\n');
      codeLines.push('local instance_a = My_Psuedo_Class:new()\nlocal instance_b = My_Psuedo_Class:new()\n');
      codeLines.push('instance_a:print()\ninstance_b:print()\nprint()\n');
      codeLines.push('My_Psuedo_Class.shared = \u0022new shared state\u0022\n');
      codeLines.push('instance_a:print()\ninstance_b:print()\nprint()\n');
      codeLines.push('instance_a:method(\u0027overwrite first\u0027)\ninstance_b:method(\u0027overwrite second\u0027)\n');
      codeLines.push('instance_a:print()\ninstance_b:print()\nprint()\n');
      codeLines.push('My_Psuedo_Class.shared = \u0022only in inst. c\u0022\nlocal instance_c = My_Psuedo_Class:new()\n');
      codeLines.push('instance_a:print()\ninstance_b:print()\ninstance_c:print()\n');
      codeLines.push('');
      codeLines.push('');
      codeLines.push('');
      codeLines.push('');
      
    </script>
    <script src="/site.js" async></script>
  </body>
</html>
